{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _eventemitter = _interopRequireDefault(require(\"eventemitter3\"));\n\nvar _eth = require(\"@mainframe/eth\");\n\nvar EthereumProvider =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  (0, _inheritsLoose2.default)(EthereumProvider, _EventEmitter);\n\n  function EthereumProvider(ethClient) {\n    var _this;\n\n    _this = _EventEmitter.call(this) || this;\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"_ethClient\", void 0);\n    _this._ethClient = ethClient;\n    return _this;\n  } // Emulate older provider types that use sendAsync\n\n\n  var _proto = EthereumProvider.prototype;\n\n  _proto.sendAsync =\n  /*#__PURE__*/\n  function () {\n    var _sendAsync = (0, _asyncToGenerator2.default)(\n    /*#__PURE__*/\n    _regenerator.default.mark(function _callee(payload, cb) {\n      return _regenerator.default.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", this.send(payload, cb));\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function sendAsync(_x, _x2) {\n      return _sendAsync.apply(this, arguments);\n    }\n\n    return sendAsync;\n  }() // Emulate older provider types that use callbacks\n  ;\n\n  _proto.send =\n  /*#__PURE__*/\n  function () {\n    var _send2 = (0, _asyncToGenerator2.default)(\n    /*#__PURE__*/\n    _regenerator.default.mark(function _callee2(methodOrPayload, paramsOrCallback) {\n      var method, params, id, _response;\n\n      return _regenerator.default.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(typeof methodOrPayload === 'string' && Array.isArray(paramsOrCallback))) {\n                _context2.next = 4;\n                break;\n              }\n\n              return _context2.abrupt(\"return\", this._send(methodOrPayload, paramsOrCallback));\n\n            case 4:\n              if (!(typeof methodOrPayload !== 'object' || typeof paramsOrCallback !== 'function')) {\n                _context2.next = 6;\n                break;\n              }\n\n              throw new Error('Bad argument types');\n\n            case 6:\n              _context2.prev = 6;\n              method = methodOrPayload.method, params = methodOrPayload.params, id = methodOrPayload.id;\n              _context2.next = 10;\n              return this._send(method, params);\n\n            case 10:\n              _response = _context2.sent;\n              paramsOrCallback(null, (0, _eth.jsonRpcResponse)(_response, id));\n              _context2.next = 17;\n              break;\n\n            case 14:\n              _context2.prev = 14;\n              _context2.t0 = _context2[\"catch\"](6);\n              paramsOrCallback(_context2.t0);\n\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this, [[6, 14]]);\n    }));\n\n    function send(_x3, _x4) {\n      return _send2.apply(this, arguments);\n    }\n\n    return send;\n  }();\n\n  _proto._send =\n  /*#__PURE__*/\n  function () {\n    var _send3 = (0, _asyncToGenerator2.default)(\n    /*#__PURE__*/\n    _regenerator.default.mark(function _callee3(method, params) {\n      var response, request;\n      return _regenerator.default.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.t0 = method;\n              _context3.next = _context3.t0 === 'eth_sendTransaction' ? 3 : _context3.t0 === 'eth_accounts' ? 11 : _context3.t0 === 'eth_signTransaction' ? 16 : _context3.t0 === 'eth_sign' ? 21 : 26;\n              break;\n\n            case 3:\n              if (!this._ethClient.walletProvider) {\n                _context3.next = 10;\n                break;\n              }\n\n              _context3.next = 6;\n              return this._ethClient.generateTXRequest(params[0]);\n\n            case 6:\n              request = _context3.sent;\n              _context3.next = 9;\n              return this._ethClient.send(request.method, request.params);\n\n            case 9:\n              response = _context3.sent;\n\n            case 10:\n              return _context3.abrupt(\"break\", 29);\n\n            case 11:\n              if (!this._ethClient.walletProvider) {\n                _context3.next = 15;\n                break;\n              }\n\n              _context3.next = 14;\n              return this._ethClient.walletProvider.getAccounts();\n\n            case 14:\n              response = _context3.sent;\n\n            case 15:\n              return _context3.abrupt(\"break\", 29);\n\n            case 16:\n              if (!this._ethClient.walletProvider) {\n                _context3.next = 20;\n                break;\n              }\n\n              _context3.next = 19;\n              return this._ethClient.walletProvider.signTransaction(params[0]);\n\n            case 19:\n              response = _context3.sent;\n\n            case 20:\n              return _context3.abrupt(\"break\", 29);\n\n            case 21:\n              if (!this._ethClient.walletProvider) {\n                _context3.next = 25;\n                break;\n              }\n\n              _context3.next = 24;\n              return this._ethClient.walletProvider.sign({\n                address: params[0],\n                data: params[1]\n              });\n\n            case 24:\n              response = _context3.sent;\n\n            case 25:\n              return _context3.abrupt(\"break\", 29);\n\n            case 26:\n              _context3.next = 28;\n              return this._ethClient.send(method, params);\n\n            case 28:\n              response = _context3.sent;\n\n            case 29:\n              return _context3.abrupt(\"return\", response);\n\n            case 30:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function _send(_x5, _x6) {\n      return _send3.apply(this, arguments);\n    }\n\n    return _send;\n  }() // Signal EIP1193 support\n  ;\n\n  _proto.isEIP1193 = function isEIP1193() {\n    return true;\n  };\n\n  return EthereumProvider;\n}(_eventemitter.default);\n\nexports.default = EthereumProvider;","map":null,"metadata":{},"sourceType":"script"}